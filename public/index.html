<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Historic Graves Text Harvester</title>

  <!-- Include Bootstrap CSS -->
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/dropzone/5.9.3/dropzone.min.css" />

  <!-- Include jQuery and Bootstrap JS -->
  <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.5.2/dist/umd/popper.min.js"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/dropzone/5.9.3/dropzone.min.js"></script>

  <!-- Custom CSS -->
  <link rel="stylesheet" href="/css/styles.css" />
  <link rel="icon" href="/images/favicon.ico" type="image/x-icon" />
</head>

<body>
  <nav class="navbar navbar-expand-lg navbar-light bg-light">
    <a class="navbar-brand" href="index.html">
      <img src="/images/logo.png" alt="Historic Graves Logo" style="height: 50px; margin-right: 10px" />
      Historic Graves Text Harvester
    </a>
    <div class="collapse navbar-collapse" id="navbarNav">
      <ul class="navbar-nav ml-auto">
        <li class="nav-item">
          <a class="nav-link" href="schemas.html">Schemas</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="results.html">View Previous Results</a>
        </li>
      </ul>
    </div>
  </nav>

  <div class="content-wrap">
    <div class="container">
      <!-- Instructions Box -->
      <div class="card instructions">
        <div class="card-body">
          <h5 class="card-title">Instructions</h5>
          <p class="card-text mb-2" id="instructionsText">
            Drag and drop your JPEG images or PDF documents into the drop zone below, or click to select files. Files
            will be processed for text extraction and results will be available on the results page.
          </p>
          <div class="small text-muted" id="instructionsList">
            <div class="mb-1">• Supported files: JPEG, PDF (max 100MB per file)</div>
            <div class="mb-1">• PDFs: Each page processed separately</div>
            <div>• Note: PDFs must not be encrypted</div>
          </div>
        </div>
      </div>

      <!-- Source type selection -->
      <div class="card" id="sourceTypeCard">
        <div class="card-body">
          <div class="form-group mb-3">
            <label for="sourceTypeSelect" class="card-title d-block mb-2">Source Type</label>
            <select class="form-control" id="sourceTypeSelect"></select>
          </div>
          <div class="form-group mb-0 d-none" id="volumeIdGroup">
            <label for="volumeId">Volume ID</label>
            <input type="text" class="form-control" id="volumeId" name="volumeId" value="vol1"
              placeholder="e.g., vol1" />
          </div>
        </div>
      </div>

      <!-- Model selection will be inserted here by JavaScript -->

      <!-- Mode selector will be inserted here by JavaScript -->
      <div id="mode-selector-container"></div>


      <!-- Replace existing results checkbox -->
      <div class="card">
        <div class="card-body py-3">
          <div class="form-group mb-0">
            <div class="custom-control custom-checkbox">
              <input type="checkbox" class="custom-control-input" id="replaceExisting">
              <label class="custom-control-label" for="replaceExisting">
                Replace existing results
              </label>
            </div>
          </div>
        </div>
      </div>

      <!-- Alert Container -->
      <div id="uploadAlertContainer"></div>

      <!-- Drop Zone for File Upload -->
      <form action="/upload" class="dropzone mb-4" id="uploadForm">
        <div class="dz-message">
          Drop files here or click to upload
        </div>
      </form>

      <!-- Submit Button -->
      <button id="submitFiles" class="btn btn-success btn-lg btn-block">
        Submit Files
      </button>
    </div>
  </div>

  <footer class="footer mt-4">
    © 2025 Historic Graves Project. For more info, contact
    <a href="mailto:daniel@curlew.ie">daniel@curlew.ie</a> or
    <a href="https://www.historicgraves.ie" target="_blank">Historic Graves</a>
    website.
  </footer>

  <script type="module">
    import { initDropzone } from "/js/modules/index/dropzone.js";
    initDropzone();
  </script>
</body>

</html>